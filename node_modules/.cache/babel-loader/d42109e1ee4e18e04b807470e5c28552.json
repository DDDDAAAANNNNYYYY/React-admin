{"ast":null,"code":"var _jsxFileName = \"/Users/danyangliu/Downloads/React-admin/src/pages/role/index.jsx\";\nimport React, { Component } from \"react\"; // import { Card, Button, Table, Modal, message } from \"antd\";\n\nimport { PAGE_SIZE } from \"../../utils/constant\";\nimport { reqContact, reqUserInfo } from \"../../api\";\nimport AddForm from \"./add-form.jsx\";\nimport SetTree from \"./setTree\";\nimport { get } from \"store\";\nimport memoryUtils from '../../utils/memoryUtils';\nimport { formateDate } from '../../utils/dataUtils';\nimport storageUtils from \"../../utils/storageUtils\";\nimport ReactDOM from 'react-dom';\nimport 'antd/dist/antd.css';\nimport axios from \"axios\";\n/* 角色路由 */\n// export default class Role extends Component {\n//   state = {\n//     loading: false,\n//     roles: [],\n//     role: {},\n//     showStatus: 0,\n//   };\n//   constructor(props){\n//       super(props)\n//       this.auth= React.createRef()\n//   }\n//   getRoles = async () => {\n//     const result = await reqRoleList();\n//     if (result.status === 0) {\n//       const roles = result.data;\n//       this.setState({\n//         roles,\n//       });\n//     }\n//   };\n//   initColumn = () => {\n//     this.columns = [\n//       {\n//         title: \"角色名称\",\n//         dataIndex: \"name\",\n//       },\n//       {\n//         title: \"创建时间\",\n//         dataIndex: \"create_time\",\n//         render:(create_time)=>formateDate(create_time)\n//       },\n//       {\n//         title: \"授权时间\",\n//         dataIndex: \"auth_time\",\n//         render:(auth_time)=>formateDate(auth_time)\n//       },\n//       {\n//         title: \"授权人\",\n//         dataIndex: \"auth_name\",\n//       },\n//     ];\n//   };\n//   handleCancel = () => {\n//     this.setState({ showStatus: 0 });\n//   };\n//   addRole = async () => {\n//     const result = await reqAddRole(this.input.props.value);\n//     if (result.status === 0) {\n//       message.success(\"添加角色成功\");\n//       // this.getRoles()\n//       // 可以不请求直接添加到roles列表\n//       const role = result.data;\n//       // const roles =[...this.state.roles]\n//       // roles.push(role)\n//       // this.setState({roles:roles})\n//       this.setState((state) => ({\n//         roles: [...state.roles, role],\n//       }));\n//     } else {\n//       message.error(\"添加角色失败\");\n//     }\n//     this.setState({ showStatus: 0 });\n//   };\n//   setRole = async() => {\n//     //   console.log('select',select)\n//      const menus =  this.auth.current.getMenus()\n//      const role = this.state.role\n//      role.menus=menus\n//      role.auth_time = Date.now()\n//      role.auth_name = memoryUtils.user.username\n//     //  console.log(role)\n//      const result = await reqUpdateRole(role)\n//      if(result.status===0){\n//          message.success('设置权限成功')\n//          //如果更新的是自己角色权限,强制退出\n//         if(memoryUtils.user.username!=='admin'&&role._id===memoryUtils.user.role_id){\n//           memoryUtils.user={}\n//           storageUtils.deleteUser()\n//           this.props.history.replace('./login')\n//           message.info('权限已更改,请重新登录')\n//         }\n//      }else{\n//          message.error('设置权限失败')\n//      }\n//     this.setState({ showStatus: 0 });\n//   };\n//   componentDidMount() {\n//     this.getRoles();\n//   }\n//   UNSAFE_componentWillMount() {\n//     this.initColumn();\n//   }\n//   render() {\n//     const { roles, role, showStatus } = this.state;\n//     // const {username, totalHours, comments, approvalStatus,submissionStatus}=this.props.location.state.user\n//     const title = (\n//       <span>\n//         <Button type=\"primary\" onClick={() => this.setState({ showStatus: 1 })}>\n//           创建角色\n//         </Button>\n//         <Button\n//           type=\"primary\"\n//           onClick={() => this.setState({ showStatus: 2 })}\n//           disabled={!role._id}\n//         >\n//           设置角色权限\n//         </Button>\n//       </span>\n//     );\n//     // console.log(roles)\n//     // console.log(this.columns)\n//     return (\n//       <Card title={title}>\n//         <Table\n//           rowKey=\"_id\"\n//           pagination={{\n//             pageSize: PAGE_SIZE,\n//             // , total: 50\n//           }}\n//           dataSource={roles}\n//           columns={this.columns}\n//           loading={this.state.loading}\n//           rowSelection={{ type: \"radio\", selectedRowKeys: [role._id],onSelect:(role)=>{\n//             this.setState({role:role})} \n//           }} //设置单选\n//           onRow={(role) => {\n//             return {\n//               onSelect:(event) => {\n//                 this.setState({ role });\n//               },\n//               onClick: (event) => {\n//                 this.setState({ role });\n//               }, // 点击行\n//               onDoubleClick: (event) => {},\n//               onContextMenu: (event) => {},\n//               onMouseEnter: (event) => {}, // 鼠标移入行\n//               onMouseLeave: (event) => {},\n//             };\n//           }}\n//           bordered\n//         />\n//         <Modal\n//           title=\"添加角色\"\n//           visible={showStatus === 1}\n//           onOk={this.addRole}\n//           onCancel={this.handleCancel}\n//           destroyOnClose={true}\n//         >\n//           <AddForm\n//             categoryName\n//             setInput={(input) => {\n//               this.input = input;\n//             }}\n//           />\n//         </Modal>\n//         <Modal\n//           title=\"设置角色权限\"\n//           visible={showStatus === 2}\n//           onOk={this.setRole}\n//           onCancel={this.handleCancel}\n//           destroyOnClose={true}\n//         >\n//           <SetTree role={role} ref={this.auth}/>\n//         </Modal>\n//       </Card>\n//     );\n//   }\n// }\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class Role extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {// this.getUserInfo();\n    };\n\n    this.getUserInfo = async () => {\n      const name = memoryUtils.user.name;\n      const result = await reqUserInfo(name);\n      console.log(\"result=>\", result);\n      this.setState({\n        userInfo: result\n      });\n      console.log(\"this.state.userinfo=>\", this.state.userInfo);\n    };\n\n    this.onFinish = async values => {\n      //console.log(\"Received values of form: \", values);\n      //\n      // console.log('this----',this)\n      const {\n        username,\n        password\n      } = values;\n\n      try {} catch (error) {}\n    };\n\n    this.saveUsers = async () => {\n      // this.state;\n      console.log(this.state);\n      const myUserInfo = this.state.userInfo;\n      axios.post(\"api/user/userInfo\", myUserInfo).then(res => {\n        alert(res);\n      });\n    };\n\n    this.handleChangeName = event => {\n      this.setState(prevState => ({ ...prevState.userInfo,\n        name: event.target.value\n      })); // alert(event.target.value\n    };\n\n    this.handleChangeEmail = event => {\n      this.setState(prevState => ({ ...prevState.userInfo,\n        email: event.target.value\n      })); // alert(event.target.value)\n    };\n\n    this.handleChangeAddress = event => {\n      this.setState(prevState => ({ ...prevState.userInfo,\n        address: event.target.value\n      })); // alert(event.target.value)\n\n      console.log(this.state);\n    };\n\n    this.handleSubmit = event => {\n      console.log(\"check new state:\", this.state.userInfo);\n      event.preventDefault();\n    };\n\n    this.state = {\n      userInfo: {}\n    }; // this.buttonClick = this.buttonClick.bind(this)\n\n    this.getUserInfo();\n  }\n\n  UNSAFE_componentWillMount() {\n    this.getUserInfo();\n  }\n\n  render() {\n    const contact = this.state.userInfo.emergencyContact; // this.props.form.setFieldsValue({ name:\"张三\", });\n\n    return /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: this.handleSubmit,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Contact\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              placeholder: \"phone\",\n              defaultValue: this.state.userInfo.name,\n              onChange: e => this.setState(prevState => {\n                let ui = Object.assign({}, prevState.userInfo);\n                ui.name = e.target.value;\n                console.log(e.target.value);\n                return {\n                  ui\n                };\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 11\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 259\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 10\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"email\",\n            defaultValue: this.state.userInfo.email,\n            onChange: e => this.setState(prevState => {\n              let ui = Object.assign({}, prevState.userInfo);\n              ui.email = e.target.value;\n              console.log(e.target.value);\n              return {\n                ui\n              };\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 260\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"address\",\n            defaultValue: this.state.userInfo.address,\n            onChange: e => this.setState(prevState => {\n              let ui = Object.assign({}, prevState.userInfo);\n              ui.address = e.target.value;\n              console.log(e.target.value);\n              return {\n                ui\n              };\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 266\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: this.state.userInfo.emergencyContact && this.state.userInfo.emergencyContact.map((contact, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: [\"Emergency Contact \", index + 1]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              placeholder: \"First Name, Last Name\",\n              defaultValue: contact.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 102\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              placeholder: \"phone\",\n              defaultValue: contact.phone\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 88\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 11\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.saveUsers,\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: this.state.errorMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 5\n    }, this) //   <div>\n    //   <Form\n    //   name=\"validate_other\"\n    //   onFinish={this.onFinish}\n    //   initialValues={{\n    //     rate: 3.5,\n    //   }}\n    // >\n    //   <Form.Item\n    //     label=\"name\"\n    //     name=\"name\"      \n    //   > \n    //     <Input defaultValue={this.state.userInfo.name} />\n    //   </Form.Item>\n    //   <Form.Item\n    //     label=\"email\"\n    //     name=\"email\"  \n    //   >\n    //     <Input defaultValue={this.state.userInfo.email}/>\n    //   </Form.Item>\n    //   <Form.Item\n    //     label=\"address\"\n    //     name=\"address\"      \n    //   >\n    //     <Input />\n    //   </Form.Item>\n    // </Form>\n    // {/* <div>\n    //   {contact.map((x, i) => {\n    //     return <span> x.name</span>\n    //   })}\n    // </div> */}\n    // </div>\n    ;\n  }\n\n}","map":{"version":3,"sources":["/Users/danyangliu/Downloads/React-admin/src/pages/role/index.jsx"],"names":["React","Component","PAGE_SIZE","reqContact","reqUserInfo","AddForm","SetTree","get","memoryUtils","formateDate","storageUtils","ReactDOM","axios","Role","constructor","props","componentDidMount","getUserInfo","name","user","result","console","log","setState","userInfo","state","onFinish","values","username","password","error","saveUsers","myUserInfo","post","then","res","alert","handleChangeName","event","prevState","target","value","handleChangeEmail","email","handleChangeAddress","address","handleSubmit","preventDefault","UNSAFE_componentWillMount","render","contact","emergencyContact","e","ui","Object","assign","map","index","phone","errorMessage"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAkC,OAAlC,C,CACA;;AACA,SAASC,SAAT,QAA0B,sBAA1B;AACA,SAASC,UAAT,EAAqBC,WAArB,QAAuC,WAAvC;AACA,OAAOC,OAAP,MAAoB,gBAApB;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,SAASC,GAAT,QAAoB,OAApB;AACA,OAAOC,WAAP,MAAwB,yBAAxB;AACA,SAAQC,WAAR,QAA0B,uBAA1B;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAO,oBAAP;AAGA,OAAOC,KAAP,MAAkB,OAAlB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A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","sourcesContent":["import React, { Component, } from \"react\";\n// import { Card, Button, Table, Modal, message } from \"antd\";\nimport { PAGE_SIZE } from \"../../utils/constant\";\nimport { reqContact, reqUserInfo} from \"../../api\";\nimport AddForm from \"./add-form.jsx\";\nimport SetTree from \"./setTree\";\nimport { get } from \"store\";\nimport memoryUtils from '../../utils/memoryUtils'\nimport {formateDate} from '../../utils/dataUtils'\nimport storageUtils from \"../../utils/storageUtils\";\nimport ReactDOM from 'react-dom';\nimport 'antd/dist/antd.css';\n\nimport { Form, Input, InputNumber, Button } from 'antd';\nimport axios from \"axios\";\n/* 角色路由 */\n// export default class Role extends Component {\n//   state = {\n//     loading: false,\n//     roles: [],\n//     role: {},\n//     showStatus: 0,\n//   };\n//   constructor(props){\n//       super(props)\n//       this.auth= React.createRef()\n//   }\n//   getRoles = async () => {\n//     const result = await reqRoleList();\n//     if (result.status === 0) {\n//       const roles = result.data;\n//       this.setState({\n//         roles,\n//       });\n//     }\n//   };\n//   initColumn = () => {\n//     this.columns = [\n//       {\n//         title: \"角色名称\",\n//         dataIndex: \"name\",\n//       },\n//       {\n//         title: \"创建时间\",\n//         dataIndex: \"create_time\",\n//         render:(create_time)=>formateDate(create_time)\n//       },\n//       {\n//         title: \"授权时间\",\n//         dataIndex: \"auth_time\",\n//         render:(auth_time)=>formateDate(auth_time)\n//       },\n//       {\n//         title: \"授权人\",\n//         dataIndex: \"auth_name\",\n//       },\n//     ];\n//   };\n//   handleCancel = () => {\n//     this.setState({ showStatus: 0 });\n//   };\n//   addRole = async () => {\n//     const result = await reqAddRole(this.input.props.value);\n//     if (result.status === 0) {\n//       message.success(\"添加角色成功\");\n//       // this.getRoles()\n//       // 可以不请求直接添加到roles列表\n//       const role = result.data;\n//       // const roles =[...this.state.roles]\n//       // roles.push(role)\n//       // this.setState({roles:roles})\n//       this.setState((state) => ({\n//         roles: [...state.roles, role],\n//       }));\n//     } else {\n//       message.error(\"添加角色失败\");\n//     }\n//     this.setState({ showStatus: 0 });\n//   };\n//   setRole = async() => {\n//     //   console.log('select',select)\n//      const menus =  this.auth.current.getMenus()\n//      const role = this.state.role\n//      role.menus=menus\n//      role.auth_time = Date.now()\n//      role.auth_name = memoryUtils.user.username\n//     //  console.log(role)\n//      const result = await reqUpdateRole(role)\n//      if(result.status===0){\n//          message.success('设置权限成功')\n//          //如果更新的是自己角色权限,强制退出\n//         if(memoryUtils.user.username!=='admin'&&role._id===memoryUtils.user.role_id){\n//           memoryUtils.user={}\n//           storageUtils.deleteUser()\n//           this.props.history.replace('./login')\n//           message.info('权限已更改,请重新登录')\n//         }\n//      }else{\n//          message.error('设置权限失败')\n//      }\n//     this.setState({ showStatus: 0 });\n//   };\n//   componentDidMount() {\n//     this.getRoles();\n//   }\n//   UNSAFE_componentWillMount() {\n//     this.initColumn();\n//   }\n//   render() {\n//     const { roles, role, showStatus } = this.state;\n//     // const {username, totalHours, comments, approvalStatus,submissionStatus}=this.props.location.state.user\n//     const title = (\n//       <span>\n//         <Button type=\"primary\" onClick={() => this.setState({ showStatus: 1 })}>\n//           创建角色\n//         </Button>\n//         <Button\n//           type=\"primary\"\n//           onClick={() => this.setState({ showStatus: 2 })}\n//           disabled={!role._id}\n//         >\n//           设置角色权限\n//         </Button>\n//       </span>\n//     );\n\n//     // console.log(roles)\n//     // console.log(this.columns)\n//     return (\n//       <Card title={title}>\n//         <Table\n//           rowKey=\"_id\"\n//           pagination={{\n//             pageSize: PAGE_SIZE,\n//             // , total: 50\n//           }}\n//           dataSource={roles}\n//           columns={this.columns}\n//           loading={this.state.loading}\n//           rowSelection={{ type: \"radio\", selectedRowKeys: [role._id],onSelect:(role)=>{\n//             this.setState({role:role})} \n//           }} //设置单选\n//           onRow={(role) => {\n//             return {\n//               onSelect:(event) => {\n//                 this.setState({ role });\n//               },\n//               onClick: (event) => {\n//                 this.setState({ role });\n//               }, // 点击行\n//               onDoubleClick: (event) => {},\n//               onContextMenu: (event) => {},\n//               onMouseEnter: (event) => {}, // 鼠标移入行\n//               onMouseLeave: (event) => {},\n//             };\n//           }}\n//           bordered\n//         />\n//         <Modal\n//           title=\"添加角色\"\n//           visible={showStatus === 1}\n//           onOk={this.addRole}\n//           onCancel={this.handleCancel}\n//           destroyOnClose={true}\n//         >\n//           <AddForm\n//             categoryName\n//             setInput={(input) => {\n//               this.input = input;\n//             }}\n//           />\n//         </Modal>\n//         <Modal\n//           title=\"设置角色权限\"\n//           visible={showStatus === 2}\n//           onOk={this.setRole}\n//           onCancel={this.handleCancel}\n//           destroyOnClose={true}\n//         >\n//           <SetTree role={role} ref={this.auth}/>\n//         </Modal>\n//       </Card>\n//     );\n//   }\n// }\nexport default class Role extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      userInfo:{},\n      \n    }\n    // this.buttonClick = this.buttonClick.bind(this)\n    this.getUserInfo();\n\n  }\n\n  UNSAFE_componentWillMount() {\n    this.getUserInfo();\n  }\n\n  componentDidMount = () => {\n    // this.getUserInfo();\n  }\n  getUserInfo = async () => {\n    const name = memoryUtils.user.name;\n    const result = await reqUserInfo(name);\n    console.log(\"result=>\",result);\n    this.setState({userInfo: result});\n    console.log(\"this.state.userinfo=>\", this.state.userInfo);\n  }\n\n  onFinish = async (values) => {\n    //console.log(\"Received values of form: \", values);\n    //\n    // console.log('this----',this)\n    const { username, password } = values;\n    \n    try {\n      \n\n   \n\n      \n    } catch (error) {\n   \n    }\n  };\n\n\n\n  saveUsers = async () => {   \n    // this.state;\n    console.log(this.state);\n    const myUserInfo = this.state.userInfo;\n    axios.post(\"api/user/userInfo\", myUserInfo).then( res=>{\n      alert(res);\n    })\n\n  };\n\n  handleChangeName = (event)=>{\n  \n    this.setState(prevState =>(\n      {\n        ...prevState.userInfo,\n        name: event.target.value\n      }\n    ))\n    // alert(event.target.value\n  }\n  handleChangeEmail = (event)=>{\n  \n    this.setState(prevState =>(\n      {\n        ...prevState.userInfo,\n        email: event.target.value\n      }\n    ))\n    // alert(event.target.value)\n   \n  }\n  handleChangeAddress = (event)=>{\n  \n    this.setState(prevState =>(\n      {\n        ...prevState.userInfo,\n        address: event.target.value\n      }\n    ))\n    // alert(event.target.value)\n    console.log(this.state)\n  }\n  handleSubmit= (event)=>{\n    console.log(\"check new state:\", this.state.userInfo)\n    event.preventDefault();\n}\n  \n\n  \n\n  render() {\n    const contact = this.state.userInfo.emergencyContact\n    \n    // this.props.form.setFieldsValue({ name:\"张三\", });\n    return (\n      \n    <form onSubmit={this.handleSubmit}>\n      <div>\n        \n        <div>\n          <h3>Contact</h3>\n\n\n         <label>\n          <input type = 'text' placeholder='phone' defaultValue = {this.state.userInfo.name} onChange={(e) => this.setState(prevState => {let ui = Object.assign({},prevState.userInfo); ui.name = e.target.value; console.log(e.target.value);  return {ui};})}/><br/>\n          </label>\n          <input type = 'text' placeholder='email' defaultValue = {this.state.userInfo.email} onChange={(e) => this.setState(prevState => {let ui = Object.assign({},prevState.userInfo); ui.email = e.target.value; console.log(e.target.value); return {ui};})}/><br/>\n          <input type = 'text' placeholder='address' defaultValue = {this.state.userInfo.address} onChange={(e) => this.setState(prevState => {let ui = Object.assign({},prevState.userInfo); ui.address = e.target.value; console.log(e.target.value); return {ui};})}/><br/>\n        </div>\n        <div>\n          {this.state.userInfo.emergencyContact && this.state.userInfo.emergencyContact.map((contact, index) =>\n          <div>\n            <h3>Emergency Contact {index + 1}</h3>\n            {/* <input type = 'text' placeholder='First Name, Last Name' defaultValue = {contact.name} onChange={(e) => {this.setState(prevState => {let s = Object.assign({}, prevState); s.emergencyContact[index].name = e.target.value; return {s};})}}/><br/> */}\n            <input type = 'text' placeholder='First Name, Last Name' defaultValue = {contact.name} /><br/>\n\n            {/* <input type = 'text' placeholder='phone' defaultValue = {contact.phone} onChange={(e) => {this.setState(prevState => {let s = Object.assign({}, prevState); s.emergencyContact[index].phone = e.target.value; return {s};})}}/><br/> */}\n            <input type = 'text' placeholder='phone' defaultValue = {contact.phone}  /><br/>\n\n          </div>\n          )}\n        </div>\n        <button onClick={this.saveUsers}>Save</button>\n        <p>{this.state.errorMessage}</p>\n      </div>\n      </form>\n    //   <div>\n    //   <Form\n    //   name=\"validate_other\"\n    //   onFinish={this.onFinish}\n    \n    //   initialValues={{\n    //     rate: 3.5,\n    //   }}\n    // >\n    //   <Form.Item\n    //     label=\"name\"\n    //     name=\"name\"      \n    //   > \n    //     <Input defaultValue={this.state.userInfo.name} />\n    //   </Form.Item>\n    //   <Form.Item\n    //     label=\"email\"\n    //     name=\"email\"  \n          \n    //   >\n       \n    //     <Input defaultValue={this.state.userInfo.email}/>\n    //   </Form.Item>\n\n    //   <Form.Item\n    //     label=\"address\"\n    //     name=\"address\"      \n    //   >\n    //     <Input />\n    //   </Form.Item>\n      \n\n    // </Form>\n    // {/* <div>\n    //   {contact.map((x, i) => {\n    //     return <span> x.name</span>\n    //   })}\n    // </div> */}\n    // </div>\n    \n    \n\n\n    )\n  }\n}\n\n"]},"metadata":{},"sourceType":"module"}